# 成本计划

- 软件项目规模成本的概念

  - 关于估算
    - 估算不是很准确的，有误差的
    - 经验（历史）数据非常重要
    - 不要太迷信数学模型
  - 软件项目规模
    - 软件项目规模即工作量，是从软件项目范围中抽出的软件功能，然后确定每个软件功能所必须执行的一系列软件工程任务
    - 包括：软件规划，软件管理，需求，设计，编码，测试，以及后期的维护等任务。
  - 规模的单位
    - LOC(Loc of Code)
      - 源代码程序长度的测量
    - FP(Function Point)
      - 用系统的功能数量来测量
    - 人月
    - 人天
    - 人年
  - 软件项目成本
    - 完成软件规模相应付出的代价。
    - 待开发的软件项目需要的资金。
    - 人的劳动的消耗所需要的代价是软件产品的主要成本
  - 成本的单位
    - 货币单位
      - 人民币元
      - 美元
      - ……..
  - 软件的规模和成本的关系
    - 规模是成本的主要因素，是成本估算的基础
    - 有了规模就确定了成本

- 估算的过程

  - 图示

    ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117221616.png)

    - ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117221617.png)

  - 估算输入

    - 项目需求、WBS
    - 历史项目度量
    - 资源要求（资源编制计划）
    - 资源消耗率:如人员成本:100元/小时
    - 进度规划：项目总进度（一般是合同要求）
    - 学习曲线

  - 成本估算方法

    - 直接成本
      - 与具体项目相关的成本
    - 间接成本
      - 不能具体到某个项目中的成本
      - 可以分摊到各个具体项目中的成本，例如：
        - 培训
        - 房租水电
        - 员工福利
        - 市场费用
        - 管理费
        - 其他等等

  - 估算结果

    - 估算文件
      - 资源，资源的数量，质量标准，估算成本等信息
      - 单位：一般是货币单位
      - BAC(Budget At completion)
    - 估算说明
      - 工作范围
      - 估算的基础和依据
      - 估算的假设
      - 估算的误差变动等

  - 估算说明

    - 预测所需要的总工作量的过程。
    - 是一种量化的结果
    - 可以有一些误差
    - 成本估算不同于项目定价
    - 贯穿于软件的生存周期。

- 估算的方法

  - 基本方法
    - 代码行、功能点
      - 代码行（LOC）
        从软件程序量的角度定义项目规模。
        - 要求功能分解足够详细的
        - 有一定的经验数据（类比和经验方法）
        - 与具体的编程语言有关
        - 优点
          - 代码是所有软件开发项目都有的“产品”，而且很容易计算代码行数。
        - 缺点
          - 对代码行没有公认的可接受的标准定义
          - 代码行数量依赖于所用的编程语言和个人的编程风格.
          - 在项目早期,需求不稳定、设计不成熟、实现不确定的情况下很难准确地估算代码量.
          - 代码行强调编码的工作量,只是项目实现阶段的一部分
      - 功能点（FP: Function point）
        用系统的功能数量来测量其规模与实现产品所使用的语言和技术没有关系的
        - 两个评估
          - 内部基本功能
          - 外部基本功能
        - 加权和量化
        - 公式
          - FP=UFC*TCF
            - UFC：未调整功能点计数
              - 功能计数项
                - 外部输入
                - 外部输出
                - 外部查询
                - 外部文件
                - 内部文件
              - 功能计数项的复杂度等级
                - ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117221618.png)
              - 实例
                - ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117221619.png)
            - TCF：技术复杂度因子
              - 计数复杂度因子
                - ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117221620.png)
              - 计数复杂度因子的取值范围
                - ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117221621.png)
              - 实例
                - FP=UFC*TCF
                  - UFC=301
                  - TCF=0.65+0.01(14*3)=1.07
                - FP=301*1.07=322
      - 功能点与代码行的转换
        - ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117221622.png)
    - 类比 (自顶向下)估算法
      - 类比的定义
        - 估算人员根据以往的完成类似项目所消耗的总成本（或工作量），来推算将要开发的软件的总成本（或工作量），然后按比例将它分配到各个开发任务单元中
        - 是一种自上而下的估算形式
      - 类比的使用情况
        - 有类似的历史项目数据
        - 信息不足（要求不是非常精确)的时候
        - 在合同期和市场招标时
      - 类比的特点
        - 简单易行,花费少
        - 具有一定的局限性
        - 准确性差,可能导致项目出现困难
    - 自下而上估算法
      - 自下而上的定义
        - 利用任务分解结构图,对各个具体工作包进行详细的成本估算,然后将结果累加起来得出项目总成本。
      - 自下而上的使用情况
        - 项目开始以后，WBS的开发阶段
        - 需要进行准确估算的时候
      - 自下而上的特点
        - 这种方法相对比较准确，它的准确度来源于每个任务的估算情况
        - 非常费时,估算本身也需要成本支持
        - 可能发生虚报现象
    - 参数法估算法
      - 参数估算法的定义
        - 一种使用项目特性参数建立数据模型来估算成本的方法，是一种统计技术，如回归分析和学习曲线。
      - 参数估算法的使用情况
        - 存在成熟的项目估算模型
        - 应该具有良好的数据库数据为基础
      - 参数估算法的特点
        - 比较简单,而且也比较准确
        - 如果模型选择不当或者数据不准,也会导致偏差
      - 经验导出成本模型
        - 提供工作量(规模)的直接估计
        - 通过过去项目数据,进行回归分析,得出的回归模型
        - 整体公式
          - E=A+B*SC
            - E:以人月表示的工作量
            - A,B,C:经验导出的系数
            - S:主要的输入参数(通常是LOC,FP等)
          - 面向LOC驱动的
            - Walston-Felix(IBM)
              - qE=5.2*(KLOC)^0.91
            - Balley-Basili
              - qE=5.5+0.73*(KLOC)^1.16
            - .COCOMO
              - E=3.2*(KLOC)^1.05
            - Doty
              - E=5.288*(KLOC)^1.047
          - 面向FP驱动的
            - Albrechtand Gaffney
              - E=-12.39+0.0545FP
            - Matson,Barnett
              - E=585.7+15.12FP
        - 建议掌握模型
          - ＩＢＭ模型－（Walston-Felix）
            1977年，IBM的Walston和Felix提出的估算公式
            - E ＝ 5.2×L ^0.91 ，L是源代码行数(以KLOC计)，E是工作量（以PM计）
            - D ＝ 4.1×L ^ 0.36，D是项目持续时间(以月计)
            - S ＝ 0.54×E ^ 0.6，S是人员需要量(以人计)
            - DOC ＝ 49×L ^ 1.01。DOC是文档数量(以页计)
            - 举例
              - 采用java 完成项目，366功能点，则
              - L =366×46 = 16386行 =16.386KLOC
              - E ＝ 5.2×L ^0.91 ＝ 5.2×16.386^ 0.91 ＝ 66人月
              - DOC＝ 49×L ^1.01 ＝ 49×16.386^ 1.01 ＝ 826页
          - COCOMO模型－(Boehm）
            结构化成本模型 是世界上应用最广泛的参数型软件成本估计模型由Barry Boehm开发的
            - COCOMO模型发展
              - COCOMO 81
              - COCOMO II
              - 模型系列
            - COCOMO 81
              - 模型类别
                - 基本COCOMO
                  静态单变量模型
                  - 公式
                    - E= a(KLOC)exp(b)
                      - E是所需的人力（人月），
                      - KLOC是交付的代码行
                      - a ， b是依赖于项目自然属性的参数：
                  - 基本COCOMO系数表
                    - ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117221623.png)
                  - 举例
                    - 一个33.3KLOC的软件开发项目，属于中等规模、半有机型的项目，采用基本COCOMO：
                    - a=3.0，b=1.12。
                    - E =3.0＊L ^1.12= 3.0＊33.3 ^1.12= 152 PM
                - 中等COCOMO
                  基本模型基础上考虑影响因素，调整模型
                  - 公式
                    - E=a(KLOC)exp(b)*乘法因子
                      - a  b是系数
                      - 乘法因子是根据成本驱动属性打分的结果，对公式的校正系数
                  - 中等COCOMO系数表
                    - ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117221624.png)
                  - 乘法因子
                    - 属性
                      - 产品属性
                      - 平台属性
                      - 人员属性
                      - 过程属性
                    - 图示
                      - ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117221625.png)
                    - 乘法因子计算
                      - 每个属性Fi的取值范围为：   很低、低、正常、高、很高、极高，共六级。正常情况下 Fi=1。
                      - 当每个Fi的值选定后，乘法因子的计算如下                   乘法因子＝F1*F2*… Fi …* Fn
                  - 举例
                    - 一个33.3KLOC的软件开发项目，属于中等规模、半有机型的项目，采用中等COCOMO模型
                    - a=3.0，b=1.12。
                    - 乘法因子＝0.70*0.85*1……*1.15=1.09
                    - E  = 3.0＊L ^1.12= 3.0＊33.3 ^1.12×１.０９＝１６６PM
                - 高级COCOMO
                  中等COCOMO模型基础上考虑各个步骤的影响
                  - 将项目分解为一系列的子系统或者子模型
                  - 在一组子模型的基础上更加精确地调整一个模型的属性
                  - 图示
                    - ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117221626.png)
              - 项目类型
                - 有机:Organic
                  - 各类应用程序，例如数据处理、科学计算等
                  - 受硬件的约束比较小，程序的规模不是很大
                - 嵌入式:Embedded
                  - 系统程序，例如实时处理、控制程序等
                  - 紧密联系的硬件、软件和操作的限制条件下运行，软件规模任意
                - 半有机:Semidetached
                  - 各类实用程序，介于上述两种软件之间，例如编译器（程序）
                  - 规模和复杂度都属于中等或者更高
    - 专家估算法
      由多位专家进行成本估算，一个专家可能会有偏见，最好由多位专家进行估算，取得多个估算值,最后得出综合的估算值。
      - 流程
        - 组织者发给每位专家一份软件系统的规格说明和一张记录估算值的表格，请他们估算
        - 专家详细研究软件规格说明后，对该软件提出3个规模的估算值
          - 最小ai
          - 最可能的mi
          - 最大bi
        - 组织者对专家的表格中的答复进行整理
        - 计算每位专家的Ei=(ai+4mi+bi)/6
        - 综合结果后:E=E1+E2+…En/n（N:表示N 个专家）
        - 再组织专家无记名填表格，比较估算差，并查找原因
        - 如果各个专家的估算差异超出规定的范围（例如：15%），则需重复上述过程，最终可以获得一个多数专家共识的软件规模
      - 举例
        - 某多媒体信息查询系统—专家估算
        - 专家1：1，8，9=〉（1+9+4* 8 ）/6=7（万元）
        - 专家2： 4， 6 ， 8=〉（4+8+4*6）/6=6 （万元）
        - 估算结果=（6+7）/2=6.5（万元）
    - 综述
      - 主要考虑三种模型
        - 类比法
        - 自下而上法
        - 参数法.
      - 自下而上法费时费力,参数法比较简单
      - 自下向上法与参数法的估计精度相似
      - 类比法通常用来验证参数法和自下而上法的结果
      - 各种方法不是孤立的,应该注意相互的结合使用
  - 实用软件估算模型
    - 是一种自下而上和参数法的结合模型,步骤如下:
      - 对任务进行分解:1,2,…,i…
      - 估算每个任务的成本Ei
        - 直接估算成本Ei
        - 先估算规模Qi，然后估算成本Ei= Qi *人力成本参数
          - 唯一估计值：Qi=Avg
          - PERT算法: Qi=(Max+4Avg+Min)/6
      - 直接成本=E1+E2+……+Ei+……+ En
      - 项目总估算成本
        - 项目总估算成本= 直接成本+间接成本
          - 直接成本
            - 直接成本=规模*人力成本参数
            - 直接成本组成
              - 开发成本
              - 管理成本
              - 质量成本
            - 例如：人力成本参数=2万/人月，30人月规模的项目的直接成本是 60万
            - 简易估算
              - 开发（工作量）规模：Scale(Dev) (单位：人月)
              - 管理、质量（工作量）规模：Scale(Mgn)=a* Scale(Dev)
                - [a为比例系数：例如：20%--25%]
              - 直接成本＝ Scale(Dev) ＋ a*Scale(Dev)
          - 间接成本
            - 按照企业模型直接估算
            - 简易算法
              - 间接成本=直接成本*间接成本系数
              - 间接成本= 规模*人力成本参数*间接成本系数
              - 例如：间接成本系数=0.3
      - 项目总报价
        - 项目总报价=项目总估算成本+风险利润
          - 风险利润=利润+风险基金+税
            - 项目利润=估算成本*a%
            - 风险基金=估算成本*b%
            - 税=估算成本*c%(例如:c为5.5左右)
        - 项目总报价=(a+b+c) %*项目总估算成本+项目总估算成本


## 成本预算

- 成本预算是将项目的总成本按照项目的进度分摊到各个工作单元中去。
- 成本预算将总的成本安排到各个任务中 
- 目的
  - 产生成本基线

- 分配项目成本预算包括三种情况

  - 分配资源成本
    - 资源成本与资源的基本费率紧密相连
    - 设置资源费率
      - 标准费率
      - 加班费率
      - 每次使用费率等
  - 给任务分配固定资源成本
    - 当一个项目的资源需要固定数量的资金时，用户可以向任务分配固定资源成本。
    - 例如：需要的硬件设备
  - 给任务分配固定成本
    - 有些任务是固定成本的类型的任务，也就是说，用户知道某项任务的成本不变，不管任务的工期有多长，或不管任务使用了那些资源。在这种情况下，用户向任务直接分配成本。
    - 例如：培训任务

- 估算准确度


| 类型                               | 准确度    | 说明                 |
| ---------------------------------- | --------- | -------------------- |
| 量级估算:合同前 Order of magnitude | -25~~+75% | 概念和启动阶段 决策  |
| 预算估算:合同期 Budget             | -10~~+25% | 编制初步计划         |
| 确定性估算:WBS后Definitive         | -5~~+10%  | 工作分解后的详细计划 |

- 估算不准的原因

  - 基础数据不足
  - 缺乏经验的估算人员
  - 签约前后不连贯
  - 低劣的推测技术
  - 估算对需求的敏感性

- 避免低劣估算

  - 避免无准备的估算
  - 留出估算的时间，并做好计划
  - 使用以前的项目数据
  - 使用开发人员提供的数据为基础估算
  - 分类法估算
  - 详细的较低层次上的估算
  - 使用软件估算工具
  - 使用几种不同估算技术，并比较它们的结果

- 估算的表达方式技巧

  - 加减限定

    - 6个人月，+3人月，-1人月

  - 范围

    - 5-9人月

  - 风险量化

    - 见下例


  | 估算：6个人月，+3，-2            |                                |
  | -------------------------------- | ------------------------------ |
  | +1人月：延迟交付转换子系统       | -1人月：新成员的工作效率高     |
  | +1人月：采用的新工具没有预计的好 | -1人月：采用的新工具比预计的好 |
  | +0.5人月:员工病事假              |                                |
  | +0.5人月:低估规模                |                                |

  - 情况

    - 见下：案例估算的例子


| 情况     | 估算    |
| -------- | ------- |
| 最佳情况 | 100人月 |
| 计划情况 | 110人月 |
| 最差情况 | 150人月 |





### 软件工程中的真相与假象

真相8:造成软件项目失控最普遍的两个原因之一就是软件估算不足(另外的原因是需求不稳定). 

真相9:往往在错误的时间,甚至在没有定义需求也即没有理解问题之前,就进行软件估算. 

真相10:往往由错误的人员,即不是由软件开发人员或者项目经理,而是由高层管理或者市场营销,进行软件估算. 

真相11:由错误的人员、在错误的时间做出的软件估算不但往往是错误的,也很少随着项目的进行做必要的调整. 

真相12:虽然软件估算会发生如此错误,但是人们不去关心产生错误的原因,却还在努力按照错误估算的时间进度执行. 

真相13:管理人员和技术人员对软件估算的认识是完全隔绝的,因此也难以达到一致的目标. 

真相14:很少有真正的可行性研究. 

假象6:要估算软件项目开发时间和开发成本,必须首先估算软件项目的代码行数







